---
title: "hw4_2"
author: "b03801053公衛四劉倢如"
date: "2017年11月23日"
output: html_document
---

藉由k-means來做分群，看看文章相近的能分成幾群

```{r }
source('MLDM_facebook_new1.R')
str(doc.tfidf)
summary(doc.tfidf)


plot(doc.tfidf, main = "% of favourable responses to
     1 and 2", pch =20, cex =2)

set.seed(11)#因為有11篇文章
km1 = kmeans(doc.tfidf, 2, nstart=50)#先隨意拿兩個(其實就是主觀的降維)來畫圖



plot(doc.tfidf, col =(km1$cluster +1) , main="article analysis", pch=20, cex=2)


mydata <- doc.tfidf
wss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:30) wss[i] <- sum(kmeans(mydata,centers=i)$withinss)
plot(1:30, wss, type="b", xlab="Number of Clusters",
     ylab="Within groups sum of squares",
     main="Assessing the Optimal Number of Clusters with the Elbow Method",
     pch=20, cex=2)

set.seed(7)
km2 = kmeans( doc.tfidf, 4, nstart=50)

# Examine the result of the clustering algorithm
km2

plot(doc.tfidf, col =(km2$cluster +1) , main="K-Means result with 4 clusters", pch=20, cex=2)
```


由於組內的變異其實都很小，彼此間的差異沒有很大，分群現象沒有很明顯，因此藉由取變異約0.8左右的點來做區分，約分為四群
